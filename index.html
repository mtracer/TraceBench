<!DOCTYPE html>
<HTML>
<head>
<meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="TraceBench : An open data set for trace-oriented monitoring">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>TraceBench</title>
</head>
<BODY>
<h1 align='center'>Welcome to TraceBench! (<a href='http://www.wsdream.net/mtracer-viz/'>Try it</a>)</h1>
<hr/>
<div>&bull;&nbsp;<a href="#Overview"> Overview </a></div>
<div>&bull;&nbsp;<a href="#Download"> Download </a></div>
<div>&bull;&nbsp;<a href="#start"> Getting Start </a></div>
<div>&bull;&nbsp;<a href="#Trace"> Trace </a></div>
<div>&bull;&nbsp;<a href="#Storing"> Data Storing </a></div>
<div>&bull;&nbsp;<a href="#Structure"> Structure </a></div>
<div>&bull;&nbsp;<a href="#Environment"> Environment </a></div>
<div>&bull;&nbsp;<a href="#Workload"> Workload </a></div>
<div>&bull;&nbsp;<a href="#Faults"> Faults </a></div>
<div>&bull;&nbsp;<a href="#Applications"> Applications </a></div>
<div>&bull;&nbsp;<a href="#Contact"> Contact us </a></div>
<hr/>
<a name="Overview"></a>
<p><h2>Overview</h2></p>
<p>TraceBench is an open data set for trace-oriented monitoring, collected using <a href='http://mtracer.github.io/MTracer/'>MTracer</a> on a HDFS system deployed in a real IaaS environment. When collecting, we considered different scenarios, involving multiple scales of clusters, different kinds of user requests, various speeds of workloads, etc. In addition to recording the traces when the HDFS runs normally, we also collected the traces under the situations with various faults injected. There are 17 faults we have injected, including function and performance faults (and real system bugs). The traces in TraceBench are clustered in different MySQL files, and each file records the traces collected under a certain situation. The total collection time of TraceBench is more than 180 hours, resulting 364 files that record more than 370,000 traces. We believe TraceBench is helpful for the research of trace-based monitoring and many other topics.</p>


<br>
<a name="Download"></a>
<p><h2>Download</h2></p>
<div> TraceBench is freely available. If you use TraceBench in you work, please cite our paper (<a href='images/JingwenZhou-CloudCom-2014.pdf'>pdf</a>&nbsp;<a href='images/JingwenZhou-CloudCom-2014.pptx'>slides</a>) using following reference.</div>

<table border=1 cellspacing=0 cellpadding=3>
<tr><td>&bull;&nbsp;Jingwen Zhou, Zhenbang Chen, Ji Wang, Zibin Zheng, and Michael R. Lyu, "TraceBench: An open data set for trace-oriented monitoring," in Proceedings of the 6th IEEE International Conference on Cloud Computing Technology and Science (CloudCom 2014), pp. 519¨C526. IEEE Computer Society, 2014. DOI: 10.1109/CloudCom.2014.79</td></tr>
</table>
<div>or</div>
<table border=1 cellspacing=0 cellpadding=3>
<tr><td>
<div>@inproceedings{Zhou-CloudCom-2014,</div>
<div>title={TraceBench: An open data set for trace-oriented monitoring},</div>
<div>author={Jingwen Zhou, Zhenbang Chen, Ji Wang, Zibin Zheng, and Michael R. Lyu},</div>
<div>booktitle={Proceedings of the 6th IEEE International Conference on Cloud Computing Technology and Science (CloudCom 2014)},</div>
<div>publisher={IEEE Computer Society},</div>
<div>pages={519¨C526},</div>
<div>year={2014},</div>
<div>url={http://mtracer.github.io/TraceBench/},</div>
<div>doi={10.1109/CloudCom.2014.79},</div>
<div>}</div>
</td></tr>
</table>

<p> Download TraceBench (<a class="zip_download_link" href="https://github.com/mtracer/TraceBench/zipball/master">zip</a>, <a class="tar_download_link" href="https://github.com/mtracer/TraceBench/tarball/master">tar.gz</a>). Maybe you also need <a href='http://mtracer.github.io/MTracer-Viz/'>MTracer-Viz</a> for visualization.</p>


<!--
<script language="javascript" type="text/javascript">
function download()
{
	var name=document.getElementById("name");
	var affiliation=document.getElementById("affiliation");
	var others=document.getElementById("others");
	if(name.value==""){
		alert("Please input your name");
		return;
	}
	if(affiliation.value==""){
		alert("Please input your affiliation");
		return;
	}
	

	
	
	
	window.location.href="http://www.baidu.com";	
}
</script>
<hr>
<p></p><div>Please fill in the following fields, and then download TraceBench.</div>
<div>The information is for statistical use and will be protected rigorously.</div>
<div class="downloader_info">
<form method="get" name="searchForm">
	<dt>Name <input id="name"/>*</dt>
	<dt>Affiliation <input id="affiliation" style="width:400"/>*</dt>
	<dt>Other words you want to say:</dt><dt><textarea id="others" cols="70" rows="5" ></textarea></dt>
	<input style="width:180" type="button" value="Submit and download" onclick="download()"/>
</form>
-->




<a name="start"></a><br>
<p><h2>Getting Start</h2></p>
Following steps are a way for visualizing traces in TraceBench:
<div>1. Make sure you <a href='http://mtracer.github.io/MTracer-Viz/'>install MTracer-Viz</a> successfully</div>
<div>2. Put all the downloaded files into the directory MTracer-Viz\webapps\database.</div>
<div>3. Open MTracer-Viz in local browser, and click the link "Database" in homepage, then you can see the files of TraceBench.</div>
<div>4. Click the button "enable" to enable the file you are interested in, and you will see the related traces in the browser.</p>
<p>Or, you can see TraceBench <a href='http://www.wsdream.net/mtracer-viz'>on line</a>.</p>


<a name="Trace"></a><br>
<p><h2>Trace</h2></p>
<div> A trace in TraceBench records the handling process of a user request. The trace consists of events and edges, where the event records information of executing an operation, like function, and the edge records the relationship between events, like function call. Following are some samples chosen from TraceBench.</div>
<table border=1 cellspacing=0 cellpadding=3>
<tr><th></th><th>Request</th><th>Description</th><th>Details</th></tr>
<tr><td>1</td><td>ls</td><td>list all files in HDFS</td><td><a href='images/tree-ls.svg'>Trace Tree</a>&nbsp;|&nbsp;<a href='images/event-ls.txt'>Events</a>&nbsp;|&nbsp;<a href='images/edge-ls.txt'>Edges</a></td></tr>
<tr><td>2</td><td>copyFromLocal</td><td>upload a file (1 data blocks) from local to HDFS</td><td><a href='images/tree-write.svg'>Trace Tree</a>&nbsp;|&nbsp;<a href='images/event-write.txt'>Events</a>&nbsp;|&nbsp;<a href='images/edge-write.txt'>Edges</a></td></tr>
<tr><td>3</td><td>copyToLocal</td><td>download a file (2 data block) from HDFS to local</td><td><a href='images/tree-read.svg'>Trace Tree</a>&nbsp;|&nbsp;<a href='images/event-read.txt'>Events</a>&nbsp;|&nbsp;<a href='images/edge-read.txt'>Edges</a></td></tr>
<tr><td>4</td><td>copyFromLocal</td><td>a write requst with function fault, reflecting <br>in Trace Tree and the Description field of Events</td><td><a href='images/tree-funcAb-write.svg'>Trace Tree</a>&nbsp;|&nbsp;<a href='images/event-funcAb-write.txt'>Events</a>&nbsp;|&nbsp;<a href='images/edge-funcAb-write.txt'>Edges</a></td></tr>
<tr><td>5</td><td>copyToLocal</td><td>a read requst with performance fault, reflecting <br>in the latencies of events</td><td><a href='images/tree-perfAb-read.svg'>Trace Tree</a>&nbsp;|&nbsp;<a href='images/event-perfAb-read.txt'>Events</a>&nbsp;|&nbsp;<a href='images/edge-perfAb-read.txt'>Edges</a></td></tr>
</table><br>
<div>The method of constructing a trace tree from events and edges is following:</div>
<img src='images/reconstruction.png'>
<div>(a)&nbsp;Pick out all the events and edges with TraceID.</div>
<div>(b)&nbsp;Classify the picked events to different classes with NID.</div>
<div>(c)&nbsp;Calculate the relationships of the events in each class according to the time stamps. For example, (F1.startTime < F2.startTime) and (F1.endTime > F2.endTime) mean F1 is the ancestor of F2.</div>
<div>(d)&nbsp;Construct the relationships between classes using edges. The node, identified by the fatherNID and fatherStartTime fields, is the father of all the root nodes in the class decided by the childNID field.</div><br>

The computational complexity of the construction procss is O(nm+n<sup>2</sup>/m) on average and O(n<sup>2</sup>) in the worst case, where n is the number of the events and m is the number of edges. Following, we give the analysis process:
<div>We first respectively analyze the computational complexity of each construction step.</div>
<div>&bull;&nbsp;Step (a) picks out all the events and edges of the under-reconstructed trace from the database. Actually, the database querying operation is not a part of our reconstruction algorithm. Therefore, we do not consider the computational complexity of this step.</div>
<div>&bull;&nbsp;Step (b) classifies the picked events into classes according to nid, i.e., for each event in the trace, finds the class with the same nid. Therefore, the computational complexity of step (b) is O(n * N<sub>class</sub>), where N<sub>class</sub> means the number of the classes.</div>
<div>&bull;&nbsp;Step (c) calculates the relationships in each class using the time stamps, in which each event needs to compare with all the other events in the same class. Therefore, the computational complexity of step (c) is O(n * N<sub>eventinclass</sub>), where N<sub>eventinclass</sub> the average number of the events in a class.</div>
<div>&bull;&nbsp;Step (d) constructs the relationships between classes using edges, i.e., finds the father event and the child class for each edge. Thus, the computational complexity of step (d) is O(m * (n + N<sub>class</sub>)).</div>
<div>Therefore, the computational complexity of the whole reconstruction process is O(n * N<sub>class</sub>)+O(n * N<sub>eventinclass</sub>)+O(m * (n+N<sub>class</sub>)). With the relationships of n > m, N<sub>class</sub> = m + 1 and N<sub>class</sub> * N<sub>eventinclass</sub> = n, the computational complexity can be simplified to O(nm + n<sup>2</sup>/m). In the worst case, i.e., the trace contains only one class (i.e., m = 0) or each class contains only one event (i.e., n = m + 1), the computational complexity becomes to O(n<sup>2</sup>).</div>
<br>



<a name="Storing"></a>
<p><h2>Data Storing</h2></p>
<div>Traces are stored in the form of events and edges. There are following four tables in MySQL for storing data.</div>
<table border=1 cellspacing=0 cellpadding=3>
<tr><th>Table</th><th>Fields</th><th>Description</th></tr>
<tr><td rowspan=7>Event</td><td>TraceID</td><td>ID of the trace containing this event.</td></tr>
<tr><td>NID</td><td>Mentioned above.</td></tr>
<tr><td>OpName</td><td>Name of the operation recorded by this event.</td></tr>
<tr><td>StartTime/EndTime</td><td>Timestamps of starting/finishing the operation.</td></tr>
<tr><td>HostAddress/HostName</td><td>Host IP/Name of generating this event.</td></tr>
<tr><td>Agent</td><td>Location of the operation inside the code, usually meaning class.</td></tr>
<tr><td>Description</td><td>Some results of executing the operation, including exceptions.</td></tr>
<tr><td rowspan=1>Edge</td><td>TraceID/FatherNID/FatherStartTime/ChildNID</td><td>Mentioned above.</td></tr>
<tr><td rowspan=5>Trace</td><td>TraceID</td><td>Mentioned above.</td></tr>
<tr><td>Title</td><td>Name of the trace.</td></tr>
<tr><td>NumEvents/NumEdges</td><td>Number of events/edges included by this trace.</td></tr>
<tr><td>FirstSeen/LastUpdated</td><td>Time of first/last receiving the data in this trace on monitor server.</td></tr>
<tr><td>StartTime/EndTime</td><td>Timestamps of starting/finishing this event.</td></tr>
<tr><td rowspan=3>Operation</td><td>OpName</td><td>Name of the operation, corresponding to the <em>OpName</em> field in <em>Event</em> table.</td></tr>
<tr><td>Num</td><td>Number of events recording this operation.</td></tr>
<tr><td>MaxLatency/MinLatency/AverageLatency</td><td>Maximal/minimal/average latency of this operation.</td></tr>
</table>
<p>Data in <em>Trace</em> and <em>Operation</em> are the statistic information, which can be extracted from the <em>Event</em> and <em>Edge</em>. In other words, the <em>Event</em> and <em>Edge</em> record all needed data of traces.</p>
<div>Note that, the terms used in implementation maybe a little different from above. Here are some of them: Task=Trace, TID=NID, Report=Event, Delay=Latency</div>
<br>


<a name="Structure"></a><br>
<p><h2>Structure</h2></p>
<div>The structure of TraceBench is shown in following table:</div>
<table border=1 cellspacing=0 cellpadding=3>
<tr><th>Class</th><th>Type</th><th>Fault</th><th>Workload</th><th>Variable</th></tr>
<tr><td rowspan=2>Normal (NM)</td><td>Clientload (CL)</td><td>-</td><td>r/w/rw/rpc/rwrpc</td><td>1,5i Clients (C)</td></tr>
<tr><td>Datanode (DN)</td><td>-</td><td>r/w/rw</td><td>1,5i datanodes (DN)</td></tr>
<tr><td rowspan=14>Abnormal (AN)</td><td rowspan=2>Process (Proc)</td><td>killDN</td><td>r/w</td><td>0,1,2,3,4,5i FDN</td></tr>
<tr><td>suspendDN</td><td>r/w</td><td>1,2,3,4,5i FDNs</td></tr>
<tr><td rowspan=3>Network (Net)</td><td>disconnectDN</td><td>r/w</td><td>1,2,3,4,5i FDN</td></tr>
<tr><td>slowHDFS</td><td>r/w/rpc</td><td>0,10i/2i/100i ms</td></tr>
<tr><td>slowDN</td><td>r/w</td><td>1,2,3,4,5i FDNs</td></tr>
<tr><td rowspan=6>Data</td><td>corruptBlk</td><td>r</td><td>0,1,2,3,4,5i FDN</td></tr>
<tr><td>corruptMeta</td><td>r</td><td>0,1,2,3,4,5i FDN</td></tr>
<tr><td>lossBlk</td><td>r</td><td>1,2,3,4,5i FDN</td></tr>
<tr><td>lossMeta</td><td>r</td><td>1,2,3,4,5i FDN</td></tr>
<tr><td>cutBlk</td><td>r</td><td>1,2,3,4,5i FDN</td></tr>
<tr><td>cutMeta</td><td>r</td><td>1,2,3,4,5i FDN</td></tr>
<tr><td rowspan=3>System (Sys)</td><td>panicDN</td><td>r/w</td><td>1,2,3,4,5 FDN</td></tr>
<tr><td>deadDN</td><td>r/w</td><td>1,2,3,4,5 FDN</td></tr>
<tr><td>readOnlyDN</td><td>w</td><td>1,2,3,4,5 FDN</td></tr>
<tr><td rowspan=6>Combination (COM)</td><td rowspan=5>Single (Sin)</td><td>Process (Proc)</td><td>rwrpc</td><td>1,2,3</td></tr>
<tr><td>Network (Net)</td><td>rwrpc</td><td>1,2,3</td></tr>
<tr><td>Data</td><td>rwrpc</td><td>1,2,3</td></tr>
<tr><td>System (Sys)</td><td>rwrpc</td><td>1,2,3</td></tr>
<tr><td>Bug </td><td>rwrpc</td><td>1,2,3</td></tr>
<tr><td>Multiple (Mul)</td><td>AnarchyApe (AA)</td><td>rwrpc</td><td>1,2,3</td></tr>
</table>
<p> In TraceBench, we name a set of traces according to the items of the columns in the table, i.e., ¡°[Class](_[Type](_[Fault](_[Workload](_[Variable])?)?)?)?¡± in the form of the regular expression, where the words means the sets of items appeared in corresponding columns of the table. In addition, abbreviations given in the brackets in the table are used for compressing the names. As an example, the trace set named as Normal_Clientload_-_r, or NM_CL_r for short, contains the traces collected under the workload r in the Clientload type of Normal class. </p>
<br>

<a name="Environment"></a><br>
<p><h2>Environment</h2></p>
<br> TraceBench is collected in a real environment, which consists of more than 100 virtual machines hosted on our IaaS platform, i.e., <a href='http://cloudstack.apache.org/'>CloudStack</a>. Following figure shows the environment of our collection.</br>

<p><img src='images/environment.jpg'></p>

<div>The environment consists of following component:</br>
<div>&bull;&nbsp;<a href='http://hadoop.apache.org/'>HDFS</a>: providing a distributed storage service, con taining 50 datanodes and one namenode.</div>
<div>&bull;&nbsp;Clients: used to generate workloads to HDFS, to simulate the real usages of HDFS, containing 50 hosts.</div>
<div>&bull;&nbsp;<a href='http://mtracer.github.io/MTracer/'>MTracer</a> Server: receiving, storing and visualizing traces generated when HDFS processes the requests from clients.</div>
<div>&bull;&nbsp;Controller: controlling the whole process of collection, and also being in charge of injecting faults.</div>
<div>&bull;&nbsp;<a href='http://ganglia.info/'>Ganglia</a> Server [4]: monitoring the whole environment, to help for solving the unexpected issues in collection, like VMs are shut down by accident.</div>
<div> The MTracer Server is deployed on a VM with 4 GB memory and 8 ¡Á 1 GHz CPU, while all the rest hosts are deployed on the VMs with 2 GB memory and 4 ¡Á 1 GHz CPU. The OS that all the VMs use is CentOS 6.3.</div>
<br>

<a name="Workload"></a><br>
<p><h2>Workload</h2></p>
<p>During collection, we introduce following 5 workload:</p>

<table border=1 cellspacing=0 cellpadding=3>
<tr><th>Workload</th><th>Contained HDFS requests</th></tr>
<tr><td>r</td><td>copyToLocal</td></tr>
<tr><td>w</td><td>copyFromLocal</td></tr>
<tr><td>rpc</td><td>mkdir, touchz, mv, chmod, chown, ls, count, rmr</td></tr>
<tr><td>rw</td><td>r+w</td></tr>
<tr><td>rwrpc</td><td>r+w+rpc</td></tr>
</table>

<a name="Faults"></a><br>
<p><h2>Faults</h2></p>
<div>We introduced 17 faults in 5 types, we explain each of them as follows</div>
<table border=1 cellspacing=0 cellpadding=3>
<tr><th>Type</th><th>Fault</th><th>Description</th><th>Category</th><th>Selected From</th></tr>
<tr><td rowspan=2>Process</td><td>killDN</td><td>Kill the HDFS processes on some datanodes</td><td>Functional</td><td rowspan=14><a href='https://github.com/ynroberts/anarchyape'>AnarchyApe</a></td></tr>
<tr><td>suspendDN</td><td>Suspend the HDFS processes on some datanodes</td><td>Functional</td></tr>
<tr><td rowspan=3>Network</td><td>disconnectDN</td><td>Disconnect some datanodes from network</td><td>Functional</td></tr>
<tr><td>slowHDFS</td><td>Slow all the HDFS nodes</td><td>Performance</td></tr>
<tr><td>slowDN</td><td>Slow some datanodes</td><td>Performance</td></tr>
<tr><td rowspan=6>Data</td><td>corruptBlk</td><td>Modify all the data blocks on some datanodes</td><td>Functional</td></tr>
<tr><td>corruptMeta</td><td>Modify all the metadata files on some datanodes</td><td>Functional</td></tr>
<tr><td>lossBlk</td><td>Delete all the data blocks on some datanodes</td><td>Functional</td></tr>
<tr><td>lossMeta</td><td>Delete all the metadata files on some datanodes</td><td>Functional</td></tr>
<tr><td>cutBlk</td><td>Remove some bits in all data blocks on some datanodes</td><td>Functional</td></tr>
<tr><td>cutMeta</td><td>Remove some bits in all metadata files on some datanodes</td><td>Functional</td></tr>
<tr><td rowspan=3>System</td><td>panicDN</td><td>Make the system panic on some datanodes</td><td>Functional</td></tr>
<tr><td>deadDN</td><td>Make the system dead on some datanodes</td><td>Functional</td></tr>
<tr><td>readOnlyDN</td><td>Make the system read-only on some datanodes</td><td>Functional</td></tr>
<tr><td rowspan=3>Bug</td><td><a href='https://issues.apache.org/jira/browse/HADOOP-3257'>HADOOP-3257</a></td><td>The path in HDFS requests is limited by URI semantics</td><td>Functional</td><td rowspan=3><a href='https://issues.apache.org/jira/browse/HADOOP'>Hadoop issues repository</a></td></tr>
<tr><td><a href='https://issues.apache.org/jira/browse/HADOOP-6502'>HADOOP-6502</a></td><td>ls is very slow when listing a directory with a size of 1300</td><td>Performance</td></tr>
<tr><td><a href='https://issues.apache.org/jira/browse/HADOOP-7064'>HADOOP-7064</a></td><td>rmr does not properly check permissions of files</td><td>Functional</td></tr>
</table>
</br>

<a name="Applications"></a><br>
<p><h2>Applications</h2></p>
<p>See the applications <a href='applications.html'>here</a>.</p>


<a name="Contact"></a><br>
<p><h2>Contact us</h2></p>
<div>&bull;&nbsp;Jingwen Zhou (<a href='mailto:jwzhou@nudt.edu.cn'>jwzhou@nudt.edu.cn</a>): PhD Student, National University of Defense Technology, Changsha 410073, China</div>
<div>&bull;&nbsp;<a href='http://zbchen.github.io/'>Zhenbang chen</a> (<a href='mailto:zbchen@nudt.edu.cn'>zbchen@nudt.edu.cn</a>): Lecturer, National University of Defense Technology, Changsha 410073, China</div>
<div>&bull;&nbsp;Ji Wang: Professor, National University of Defense Technology, Changsha 410073, China</div>
<div>&bull;&nbsp;<a href='http://www.zibinzheng.com/'>Zibin Zheng</a>: Associate Research Fellow, Shenzhen Research Institute, The Chinese University of Hong Kong, Shenzhen, China</div>
<div>&bull;&nbsp;<a href='http://www.cse.cuhk.edu.hk/lyu/'>Michael R. Lyu</a>: Professor, Department of Computer Science and Engineering, The Chinese University of Hong Kong, Hong Kong, China</div>
</BODY>

















